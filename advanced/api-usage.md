# API 사용량 모니터링

API 사용량과 비용을 추적하고 관리합니다.

---

## 사용량 통계 화면

### 접근 방법

1. 설정 열기
2. "API 사용량 통계" 선택

[사진: API 사용량 메뉴]

---

## 통계 개요

### 대시보드

[사진: 사용량 대시보드]

| 항목 | 설명 |
|------|------|
| 총 비용 | 선택 기간의 총 예상 비용 |
| 총 토큰 | 사용된 총 토큰 수 |
| API 호출 | 총 API 호출 횟수 |

---

## 기간별 통계

### 기간 선택

[사진: 기간 선택 드롭다운]

| 기간 | 설명 |
|------|------|
| 오늘 | 당일 사용량 |
| 7일간 | 7일간 사용량 |
| 이번 달 | 이번 달 사용량 |
| 전체 | 누적 사용량 |

---

## 모델별 사용량

각 AI 모델별 사용량을 확인합니다.

[사진: 모델별 사용량 차트]

### 표시 정보

| 항목 | 설명 |
|------|------|
| 모델명 | API 모델 이름 |
| 입력 토큰 | 요청에 사용된 토큰 |
| 출력 토큰 | 응답으로 받은 토큰 |
| 비용 | 예상 비용 |

### 예시

```
Gemini 2.5 Flash
- 입력: 1,234,567 토큰
- 출력: 456,789 토큰
- 비용: $0.12

Gemini 2.5 Pro
- 입력: 234,567 토큰
- 출력: 78,901 토큰
- 비용: $1.45
```

---

## 소설별 사용량

각 소설별로 사용량을 확인합니다.

[사진: 소설별 사용량 목록]

### 표시 정보

- 소설 제목
- 번역된 회차 수
- 사용된 토큰
- 예상 비용

### 상세 보기

소설을 클릭하면 회차별 상세 내역을 볼 수 있습니다.

[사진: 회차별 사용량]

---

## 용도별 분류

### 카테고리

| 카테고리 | 포함 항목 |
|---------|---------|
| 번역 | 텍스트 번역 |
| 컨텍스트 | 캐릭터/용어 추출 |
| 요약 | 회차 요약 생성 |
| TTS | 음성 생성 |
| 기타 | 파싱 룰 생성 등 |

[사진: 용도별 차트]

---

## 가격 설정

### 모델별 가격 설정

각 모델의 토큰당 가격을 설정합니다.

[사진: 가격 설정 화면]

### 설정 항목

| 항목 | 설명 |
|------|------|
| 입력 가격 | 입력 토큰당 가격 ($/1M tokens) |
| 출력 가격 | 출력 토큰당 가격 ($/1M tokens) |

### 기본 가격

앱에 기본 가격이 설정되어 있으며, 공식 가격 변경 시 수동으로 업데이트해야 합니다.

---

## 비용 계산 방식

### 계산 공식

```
비용 = (입력 토큰 × 입력 단가) + (출력 토큰 × 출력 단가)
```

### 예시

```
Gemini 2.5 Flash:
- 입력: 100만 토큰 × $0.075 = $0.075
- 출력: 50만 토큰 × $0.30 = $0.15
- 합계: $0.225
```

---

## 비용 절감 팁

### 1. 효율적인 모델 선택

| 용도 | 추천 모델 |
|------|----------|
| 일반 번역 | Gemini 2.5 Flash (저렴) |
| 고품질 번역 | Gemini 2.5 Pro |
| 빠른 테스트 | Gemini 2.5 Flash Lite |

### 2. 무료 티어 활용

Gemini는 모델별로 무료 티어를 제공합니다:
- 최신 정보: [Gemini API 가격 정책](https://ai.google.dev/pricing)

### 3. 불필요한 재번역 피하기

- 컨텍스트 수정 시 "일괄 치환" 선택
- 번역 삭제 전 신중하게 결정

### 4. 적절한 컨텍스트 설정

- 컨텍스트 윈도우 줄이기
- 캐릭터 설명 길이 최적화

### 5. 프리패치 관리

- 필요한 회차만 프리패치
- TTS 프리캐시 신중하게 사용

---

## 사용량 알림

### 설정 (향후 기능)

일정 사용량 도달 시 알림 기능 (계획 중)

---

## 데이터 관리

### 내보내기

사용량 데이터를 내보낼 수 있습니다.

[사진: 내보내기 버튼]

### 초기화

사용량 데이터를 초기화합니다.

> **주의**: 초기화하면 기존 통계가 삭제됩니다.

---

## 문제 해결

### 비용이 예상보다 높음

**확인 사항**:
1. 어떤 소설이 많이 사용했는지 확인
2. 불필요한 재번역이 있었는지 확인
3. 프리패치 설정 확인

### 통계가 정확하지 않음

**원인**:
- 가격 설정이 최신이 아닐 수 있음
- 일부 호출이 기록되지 않을 수 있음

**해결**:
- 가격 설정 업데이트
- 참고용으로만 사용

### 특정 모델 사용량이 표시 안 됨

**확인**:
- 해당 모델을 실제로 사용했는지
- API 설정 체인으로 다른 모델이 사용되었을 수 있음

---

[← API 설정 체인](fallback-chain.md) | [다음: 파싱 룰 생성 →](parsing-rules.md)
